<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>로그인 페이지</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
  <style>
    .outerbox {
      width: 40%;
      margin-top: 100px;
    }


    h2 {
      margin: 0 auto;
    }

    .orange {
      background-color: orange;
    }

    a {
      text-decoration: none;
      color: #000;
    }
  </style>
</head>

<body >
  <div class="modal-dialog outerbox" role="document">
    <div class="modal-content rounded-5 shadow">
      <div class="modal-header p-5 pb-4 border-bottom-0">
        <h2 class="fw-bold mb-0">로그인</h2>
      </div>
      <div class="modal-body p-5 pt-0">
        <form class="">
          {% csrf_token %}
          <div class="form-floating mb-3">
            <input type="text" class="form-control rounded-4" id="username" placeholder="아이디를 입력해주세요">
            <label for="username">아이디</label>
          </div>
          <div class="form-floating mb-3">
            <input type="password" class="form-control rounded-4" id="password" placeholder="비밀번호를 입력해주세요">
            <label for="password">비밀번호</label>
          </div>
          <button id="login" class="w-100 mb-2 btn btn-lg btn-outline-success orange text-white" type="submit">
            로그인
          </button>
          <hr class="my-4">
          <button id="singup" class="w-100 mb-2 btn btn-lg btn-outline-success orange text-white" type="submit">
            회원가입
          </button>
          <a href="" id="find_id">아이디찾기</a>
        </form>
      </div>
    </div>
  </div>
  <script>
    $('#login').on('click', (e) => {
      e.preventDefault();
      let username = $('#username').val();
      let password = $('#password').val();
      console.log('아이디 : ' + username + ', 비밀번호 : ' + password);

      $.ajax({
        method:"POST",
        url: "http://127.0.0.1:8000/customer/login/",
        contentType: "application/json",
        data: JSON.stringify({
          "username": username,
          "password": password
        }),
      }).done(function (response) {
        alert('로그인 성공');
        alert(username + '님 반갑습니다!');
        
        sessionStorage.setItem('user_id', response.id);
        sessionStorage.setItem('user_name', response.username);
        location.href="/customer/home/";
      }).fail(function (response) {
        alert('로그인 실패');
        location.reload();
      });
    })
    $("#singup").on('click', (e) => {
      e.preventDefault();
      console.log('회원가입창으로 이동');
      location.href="/customer/signup/";
    });
    $('#find_id').on('click', (e) => {
      e.preventDefault();
      location.href="/customer/find_id/";
    })
  </script>
</body>

</html>